{"code":"!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=0)}([function(t,e,r){\"use strict\";r.r(e);var n=\".\",i={},a=function(){function t(t,e,r,n,a,o,s){void 0===n&&(n=[]),void 0===a&&(a=i),void 0===o&&(o={}),void 0===s&&(s=[]),this.value=t,this.historyValue=e,this.history=r,this.actions=n,this.activities=a,this.data=o,this.events=s}return t.from=function(e){return e instanceof t?e:new t(e)},t.inert=function(e){return e instanceof t?e.actions.length?new t(e.value,e.historyValue,e.history,[],e.activities):e:t.from(e)},t.prototype.toString=function(){if(\"string\"==typeof this.value)return this.value;for(var t=[],e=this.value;;){if(\"string\"==typeof e){t.push(e);break}var r=Object.keys(e),i=r[0];if(r.slice(1).length)return;t.push(i),e=e[i]}return t.join(n)},t}();function o(t){try{return\"string\"==typeof t||\"number\"==typeof t?\"\"+t:t.type}catch(t){throw new Error(\"Events must be strings or objects with a string event.type property.\")}}function s(t){try{return\"string\"==typeof t||\"number\"==typeof t?\"\"+t:\"function\"==typeof t?t.name:t.type}catch(t){throw new Error(\"Events must be strings or objects with a string event.type property.\")}}function u(t,e){try{return Array.isArray(t)?t:t.toString().split(e)}catch(e){throw new Error(\"'\"+t+\"' is not a valid state path.\")}}function c(t,e){return t instanceof a?t.value:\"object\"!=typeof t||t instanceof a?h(u(t,e)):t}function h(t){if(1===t.length)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function f(t,e){var r={};return Object.keys(t).forEach(function(n){r[n]=e(t[n],n,t)}),r}function l(t,e,r){var n={};return Object.keys(t).forEach(function(i){var a=t[i];r(a)&&(n[i]=e(a,i,t))}),n}var p=function(t){return function(e){for(var r=e,n=0,i=t;n<i.length;n++){r=r[i[n]]}return r}};function y(t,e){return function(r){for(var n=r,i=0,a=t;i<a.length;i++){var o=a[i];n=n[e][o]}return n}}var v=function(t){return\"string\"==typeof t?[[t]]:g(Object.keys(t).map(function(e){return v(t[e]).map(function(t){return[e].concat(t)})}))},d=function(t){var e={};if(t&&1===t.length&&1===t[0].length)return t[0][0];for(var r=0,n=t;r<n.length;r++)for(var i=n[r],a=e,o=0;o<i.length;o++){var s=i[o];if(o===i.length-2){a[s]=i[o+1];break}a[s]=a[s]||{},a=a[s]}return e},g=function(t){return t.reduce(function(t,e){return t.concat(e)},[])};function m(t,e,r){void 0===r&&(r=n);var i=c(t,r),a=c(e,r);return\"string\"==typeof a?\"string\"==typeof i&&a===i:\"string\"==typeof i?i in a:Object.keys(i).every(function(t){return t in a&&m(i[t],a[t])})}var S={start:\"xstate.start\",stop:\"xstate.stop\",raise:\"xstate.raise\",send:\"xstate.send\",cancel:\"xstate.cancel\",null:\"xstate.null\"},w=function(t){return function(e){var r=\"string\"==typeof e||\"number\"==typeof e?{type:e}:e;return{type:t,activity:o(e),data:r}}},x=function(t){return\"string\"==typeof t||\"number\"==typeof t?{type:t}:t},b=w(S.start),E=w(S.stop),k=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},N=\".\",j=\"\",_=function(t){return\"#\"===t[0]},O={guards:{}},A=function(){function t(e,r){void 0===r&&(r=O);var n=this;this.config=e,this.options=r,this.__cache={events:void 0,relativeValue:new Map,initialState:void 0},this.idMap={},this.key=e.key||\"(machine)\",this.parent=e.parent,this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=e.delimiter||(this.parent?this.parent.delimiter:N),this.id=e.id||(this.machine?[this.machine.key].concat(this.path).join(this.delimiter):this.key),this.initial=e.initial,this.parallel=!!e.parallel,this.states=e.states?f(e.states,function(e,r){var i,a=new t(k({},e,{key:r,parent:n}));return Object.assign(n.idMap,k(((i={})[a.id]=a,i),a.idMap)),a}):{},this.history=!0===e.history?\"shallow\":e.history||!1,this.on=e.on?this.formatTransitions(e.on):{},this.transient=!!this.on[j],this.strict=!!e.strict,this.onEntry=e.onEntry?[].concat(e.onEntry):[],this.onExit=e.onExit?[].concat(e.onExit):[],this.data=e.data,this.activities=e.activities}return t.prototype.getStateNodes=function(t){var e,r=this;if(!t)return[];var n=t instanceof a?t.value:c(t,this.delimiter);if(\"string\"==typeof n){var i=this.getStateNode(n).initial;return i?this.getStateNodes(((e={})[n]=i,e)):[this.states[n]]}var o=Object.keys(n);return o.map(function(t){return r.getStateNode(t)}).concat(o.reduce(function(t,e){var i=r.getStateNode(e).getStateNodes(n[e]);return t.concat(i)},[]))},t.prototype.handles=function(t){var e=o(t);return-1!==this.events.indexOf(e)},t.prototype._transitionLeafNode=function(t,e,r,n){var i=this.getStateNode(t),a=i._next(e,r,n);if(!a.value){var o=this._next(e,r,n),s=o.value,u=o.entryExitStates,c=o.actions,h=o.paths;return{value:s,entryExitStates:{entry:u?u.entry:new Set,exit:new Set([i].concat(u?Array.from(u.exit):[]))},actions:c,paths:h}}return a},t.prototype._transitionHierarchicalNode=function(t,e,r,n){var i=Object.keys(t),a=this.getStateNode(i[0]),o=a._transition(t[i[0]],e,r,n);if(!o.value){var s=this._next(e,r,n),u=s.value,c=s.entryExitStates,h=s.actions,f=s.paths;return{value:u,entryExitStates:{entry:c?c.entry:new Set,exit:new Set((o.entryExitStates?Array.from(o.entryExitStates.exit):[]).concat([a],c?Array.from(c.exit):[]))},actions:h,paths:f}}return o},t.prototype._transitionOrthogonalNode=function(t,e,r,n){var i=this,a=[],o={};if(Object.keys(t).forEach(function(s){var u=t[s];if(u){var c=i.getStateNode(s)._transition(u,e,r,n);c.value||a.push(s),o[s]=c}}),!Object.keys(o).some(function(t){return void 0!==o[t].value})){var s=this._next(e,r,n),u=s.value,c=s.entryExitStates,f=s.actions,l=s.paths;return{value:u,entryExitStates:{entry:c?c.entry:new Set,exit:new Set(Object.keys(this.states).map(function(t){return i.states[t]}).concat(c?Array.from(c.exit):[]))},actions:f,paths:l}}var y=g(Object.keys(o).map(function(t){return o[t].paths}));if(1===y.length&&!m(h(this.path),h(y[0])))return{value:this.machine.resolve(d(y)),entryExitStates:Object.keys(o).map(function(t){return o[t].entryExitStates}).reduce(function(t,e){var r=e,n=r.entry,i=r.exit;return{entry:new Set(Array.from(t.entry).concat(Array.from(n))),exit:new Set(Array.from(t.exit).concat(Array.from(i)))}},{entry:new Set,exit:new Set}),actions:g(Object.keys(o).map(function(t){return o[t].actions})),paths:y};var S=g(Object.keys(o).map(function(t){var r=o[t].value||e.value;return v(p(i.path)(r)[t]).map(function(e){return i.path.concat(t,e)})})),w=this.machine.resolve(d(S));return{value:w,entryExitStates:Object.keys(o).reduce(function(t,e){var r=o[e],n=r.value,i=r.entryExitStates;if(!n||!i)return t;var a=i.entry,s=i.exit;return{entry:new Set(Array.from(t.entry).concat(Array.from(a))),exit:new Set(Array.from(t.exit).concat(Array.from(s)))}},{entry:new Set,exit:new Set}),actions:g(Object.keys(o).map(function(t){return o[t].actions})),paths:v(w)}},t.prototype._transition=function(t,e,r,n){return\"string\"==typeof t?this._transitionLeafNode(t,e,r,n):1===Object.keys(t).length?this._transitionHierarchicalNode(t,e,r,n):this._transitionOrthogonalNode(t,e,r,n)},t.prototype._next=function(t,e,r){var n=this,i=o(e),a=this.on[i],s=this.transient?[{type:S.null}]:[];if(!a||!a.length)return{value:void 0,entryExitStates:void 0,actions:s,paths:[]};for(var u,h=[],f=0,l=a;f<l.length;f++){var y=l[f],v=y,w=v.cond,b=v.in,E=r||{},k=x(e),N=!b||m(c(b,this.delimiter),p(this.path.slice(0,-2))(t.value));if((!w||this._evaluateCond(w,E,k,t.value))&&(!b||N)){h=Array.isArray(y.target)?y.target:[y.target],s.push.apply(s,y.actions?y.actions:[]),u=y;break}}if(0===h.length)return{value:void 0,entryExitStates:void 0,actions:s,paths:[]};var j=g(h.map(function(e){return n.getRelativeStateNodes(e,t.historyValue)})),_=j.map(function(t){return t.path}),O=j.reduce(function(t,e){var r=n._getEntryExitStates(e,!!u.internal),i=r.entry,a=r.exit;return{entry:new Set(Array.from(t.entry).concat(Array.from(i))),exit:new Set(Array.from(t.exit).concat(Array.from(a)))}},{entry:new Set,exit:new Set});return{value:this.machine.resolve(d(g(h.map(function(e){return n.getRelativeStateNodes(e,t.historyValue).map(function(t){return t.path})})))),entryExitStates:O,actions:s,paths:_}},t.prototype._getEntryExitStates=function(t,e){for(var r={entry:[],exit:[]},n=this.path,i=t.path,a=this.machine,o=0;o<Math.min(n.length,i.length);o++){var s=n[o];if(s!==i[o])break;a=a.getStateNode(s)}for(var u=a.path,c=a,h=0,f=n.slice(u.length);h<f.length;h++){var l=f[h];c=c.getStateNode(l),r.exit.unshift(c)}a===this&&(e||(r.exit.push(this),r.entry.push(this))),c=a;for(var p=0,y=i.slice(u.length);p<y.length;p++){l=y[p];c=c.getStateNode(l),r.entry.push(c)}return{entry:new Set(r.entry),exit:new Set(r.exit)}},t.prototype._evaluateCond=function(t,e,r,n){var i;if(\"string\"==typeof t){if(!this.machine.options.guards[t])throw new Error(\"String condition '\"+t+\"' is not defined on machine '\"+this.machine.id+\"'\");i=this.machine.options.guards[t]}else i=t;return i(e,r,n)},t.prototype._getActions=function(t){var e={entry:t.entryExitStates?g(Array.from(t.entryExitStates.entry).map(function(t){return t.onEntry.concat(t.activities?t.activities.map(function(t){return b(t)}):[])})):[],exit:t.entryExitStates?g(Array.from(t.entryExitStates.exit).map(function(t){return t.onExit.concat(t.activities?t.activities.map(function(t){return E(t)}):[])})):[]};return(e.exit||[]).concat(t.actions||[]).concat(e.entry||[])},t.prototype._getActivities=function(t,e){if(!e.entryExitStates)return{};var r=k({},t.activities);return Array.from(e.entryExitStates.exit).forEach(function(t){t.activities&&t.activities.forEach(function(t){r[s(t)]=!1})}),Array.from(e.entryExitStates.entry).forEach(function(t){t.activities&&t.activities.forEach(function(t){r[s(t)]=!0})}),r},t.prototype.transition=function(e,r,n){var i,s=\"string\"==typeof e?this.resolve(h(this.getResolvedPath(e))):e instanceof a?e:this.resolve(e),u=o(r);if(this.strict&&-1===this.events.indexOf(u))throw new Error(\"Machine '\"+this.id+\"' does not accept event '\"+u+\"'\");var c=a.from(s),f=s instanceof a?s.historyValue?s.historyValue:this.machine.historyValue(s.value):this.machine.historyValue(s),l=this._transition(c.value,c,r,n);try{this.ensureValidPaths(l.paths)}catch(t){throw new Error(\"Event '\"+u+\"' leads to an invalid configuration: \"+t.message)}var p=this._getActions(l),y=this._getActivities(c,l),v=p.filter(function(t){return\"object\"==typeof t&&(t.type===S.raise||t.type===S.null)}),d=p.filter(function(t){return\"object\"!=typeof t||t.type!==S.raise&&t.type!==S.null}),g=l.value?this.getStateNodes(l.value):[];g.some(function(t){return t.transient})&&v.push({type:S.null});var m={};g.forEach(function(t){m[t.id]=t.data});var w=l.value?new a(l.value,t.updateHistoryValue(f,l.value),c,d,y,m,v):void 0;if(!w)return a.inert(c);delete c.history;for(var x=w;v.length;){var b=x.actions,E=v.shift();(i=(x=this.transition(x,E.type===S.null?j:E.event,n)).actions).unshift.apply(i,b)}return x},t.prototype.ensureValidPaths=function(t){var e=this,r=new Map,n=g(t.map(function(t){return e.getRelativeStateNodes(t)}));t:for(var i=0,a=n;i<a.length;i++)for(var o=a[i],s=o;s.parent;){if(r.has(s.parent)){if(s.parent.parallel)continue t;throw new Error(\"State node '\"+o.id+\"' shares parent '\"+s.parent.id+\"' with state node '\"+r.get(s.parent).map(function(t){return t.id})+\"'\")}r.get(s.parent)?r.get(s.parent).push(o):r.set(s.parent,[o]),s=s.parent}},t.prototype.getStateNode=function(t){if(_(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error(\"Unable to retrieve child state '\"+t+\"' from '\"+this.id+\"'; no child states exist.\");var e=this.states[t];if(!e)throw new Error(\"Child state '\"+t+\"' does not exist on '\"+this.id+\"'\");return e},t.prototype.getStateNodeById=function(t){var e=_(t)?t.slice(\"#\".length):t,r=this.machine.idMap[e];if(!r)throw new Error(\"Substate '#\"+e+\"' does not exist on '\"+this.id+\"'\");return r},t.prototype.getStateNodeByPath=function(t){for(var e=u(t,this.delimiter),r=this;e.length;){var n=e.shift();r=r.getStateNode(n)}return r},t.prototype.resolve=function(t){var e,r=this;if(\"string\"==typeof t){var n=this.getStateNode(t);return n.initial?((e={})[t]=n.initialStateValue,e):t}return this.parallel?f(this.initialStateValue,function(e,n){return e?r.getStateNode(n).resolve(t[n]||e):{}}):f(t,function(t,e){return t?r.getStateNode(e).resolve(t):{}})},Object.defineProperty(t.prototype,\"resolvedStateValue\",{get:function(){var t,e,r=this.key;return this.parallel?((t={})[r]=l(this.states,function(t){return t.resolvedStateValue[t.key]},function(t){return!t.history}),t):this.initial?((e={})[r]=this.states[this.initial].resolvedStateValue,e):r},enumerable:!0,configurable:!0}),t.prototype.getResolvedPath=function(t){if(_(t)){var e=this.machine.idMap[t.slice(\"#\".length)];if(!e)throw new Error(\"Unable to find state node '\"+t+\"'\");return e.path}return u(t,this.delimiter)},Object.defineProperty(t.prototype,\"initialStateValue\",{get:function(){if(this.__cache.initialState)return this.__cache.initialState;var t=this.parallel?l(this.states,function(t){return t.initialStateValue||{}},function(t){return!t.history}):\"string\"==typeof this.resolvedStateValue?void 0:this.resolvedStateValue[this.key];return this.__cache.initialState=t,this.__cache.initialState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"initialState\",{get:function(){var t,e=this.initialStateValue;if(!e)throw new Error(\"Cannot retrieve initial state from simple state '\"+this.id+\".'\");var r={},n=[];this.getStateNodes(e).forEach(function(t){t.onEntry&&n.push.apply(n,t.onEntry),t.activities&&t.activities.forEach(function(t){r[o(t)]=!0,n.push(b(t))})});for(var i=n.filter(function(t){return\"object\"==typeof t&&(t.type===S.raise||t.type===S.null)}),s=new a(e,void 0,void 0,n,r);i.length;){var u=s.actions,c=i.shift();(t=(s=this.transition(s,c.type===S.null?j:c.event,void 0)).actions).unshift.apply(t,u)}return s},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"target\",{get:function(){var t;if(this.history){var e=this.config;t=e.target&&\"string\"==typeof e.target&&_(e.target)?h(this.machine.getStateNodeById(e.target).path.slice(this.path.length-1)):e.target}return t},enumerable:!0,configurable:!0}),t.prototype.getStates=function(t){var e=this;if(\"string\"==typeof t)return[this.states[t]];var r=[];return Object.keys(t).forEach(function(n){r.push.apply(r,e.states[n].getStates(t[n]))}),r},t.prototype.getRelativeStateNodes=function(t,e,r){if(void 0===r&&(r=!0),\"string\"==typeof t&&_(t)){var n=this.getStateNodeById(t);return r?n.history?n.resolveHistory(e):n.initialStateNodes:[n]}var i=u(t,this.delimiter),a=(this.parent||this).getFromRelativePath(i,e);return r?g(a.map(function(t){return t.initialStateNodes})):a},Object.defineProperty(t.prototype,\"initialStateNodes\",{get:function(){var t=this;if(!this.parallel&&!this.initial)return[this];var e=this.initialState,r=v(e.value);return g(r.map(function(e){return t.getFromRelativePath(e)}))},enumerable:!0,configurable:!0}),t.prototype.getFromRelativePath=function(t,e){var r=this;if(!t.length)return[this];var n=t[0],i=t.slice(1);if(!this.states)throw new Error(\"Cannot retrieve subPath '\"+n+\"' from node with no states\");if(\"$history\"===n){if(!e)return[this];var a=y(this.path,\"states\")(e).current;return\"string\"==typeof a?this.states[a].getFromRelativePath(i,e):g(Object.keys(a).map(function(t){return r.states[t].getFromRelativePath(i,e)}))}var o=this.getStateNode(n);if(o.history)return o.resolveHistory(e);if(!this.states[n])throw new Error(\"Child state '\"+n+\"' does not exist on '\"+this.id+\"'\");return this.states[n].getFromRelativePath(i,e)},t.updateHistoryValue=function(t,e){return{current:e,states:function t(e,r){return f(e.states,function(e,n){if(e){var i=(\"string\"==typeof r?void 0:r[n])||(e?e.current:void 0);if(i)return{current:i,states:t(e,i)}}})}(t,e)}},t.prototype.historyValue=function(t){if(Object.keys(this.states).length)return{current:t||this.initialStateValue,states:l(this.states,function(e,r){if(!t)return e.historyValue();var n=\"string\"==typeof t?void 0:t[r];return e.historyValue(n||e.initialStateValue)},function(t){return!t.history})}},t.prototype.resolveHistory=function(t){var e=this;if(!this.history)return[this];var r=this.parent;if(!t)return this.target?g(v(this.target).map(function(t){return r.getFromRelativePath(t)})):this.parent.initialStateNodes;var n=y(r.path,\"states\")(t).current;return\"string\"==typeof n?[r.getStateNode(n)]:g(v(n).map(function(t){return\"deep\"===e.history?r.getFromRelativePath(t):[r.states[t[0]]]}))},Object.defineProperty(t.prototype,\"events\",{get:function(){if(this.__cache.events)return this.__cache.events;var t=this.states,e=new Set(Object.keys(this.on));return t&&Object.keys(t).forEach(function(r){var n=t[r];if(n.states)for(var i=0,a=n.events;i<a.length;i++){var o=a[i];e.add(\"\"+o)}}),this.__cache.events=Array.from(e)},enumerable:!0,configurable:!0}),t.prototype.formatTransition=function(t,e){var r=this,n=!!e&&e.internal,i=t.map(function(t){var e=\"string\"==typeof t&&t[0]===r.delimiter;return n=n||e,e&&!r.parent?t.slice(1):e?r.key+t:t});return k({},e,{target:i,internal:n})},t.prototype.formatTransitions=function(t){var e=this;return f(t,function(t){return void 0===t?[]:Array.isArray(t)?t.map(function(t){return e.formatTransition([].concat(t.target),t)}):\"string\"==typeof t?[e.formatTransition([t])]:Object.keys(t).map(function(r){return e.formatTransition([r],t[r])})})},t}();var V=(t=>{let e=function(t,e){return new A(t,e)}(t);return e._moString=(()=>{console.log(\"https://musing-rosalind-2ce8e7.netlify.com/?machine=\"+encodeURI(JSON.stringify(t),\"utf-8\"))}),e})({initial:\"init\",states:{init:{on:{GAME:\"start\"}},start:{on:{GAME:\"stop\",DEAD:\"dead\"}},stop:{on:{GAME:\"start\"}},dead:{on:{GAME:\"init\"}}}});var P={map:[10,20],shape:{shape1:{stateNum:2,state1:{content:[[1],[1],[1],[1],[1]],row:[0,0,0,0,0]},state2:{content:[[1,1,1,1,1]],row:[0]}},shape2:{stateNum:1,state1:{content:[[1,1],[1,1]],row:[0,0]}},shape3:{stateNum:4,state1:{content:[[1,0],[1,1],[1,0]],row:[-1,0,-1]},state2:{content:[[0,1,0],[1,1,1]],row:[-1,0]},state3:{content:[[0,1],[1,1],[0,1]],row:[0,0,0]},state4:{content:[[1,1,1],[0,1,0]],row:[0,-1]}},shape4:{stateNum:4,state1:{content:[[1,1,1],[0,0,1]],row:[0,0]},state2:{content:[[0,1],[0,1],[1,1]],row:[0,0,0]},state3:{content:[[1,0,0],[1,1,1]],row:[-2,0]},state4:{content:[[1,1],[1,0],[1,0]],row:[0,-1,-1]}},shape5:{stateNum:2,state1:{content:[[1,0],[1,1],[0,1]],row:[-1,0,0]},state2:{content:[[0,1,1],[1,1,0]],row:[0,-1]}},shape6:{stateNum:2,state1:{content:[[0,1],[1,1],[1,0]],row:[0,0,-1]},state2:{content:[[1,1,0],[0,1,1]],row:[-1,0]}}}};const M=document.getElementById(\"elsfk-bg\"),R=document.getElementById(\"elsfk-block\"),F=M.getContext(\"2d\"),B=R.getContext(\"2d\");let C=(t,e,r,n)=>{1===e?t.fillRect(r,n,20,20):t.rect(r,n,20,20)},I=t=>{t.clearRect(0,0,200,400)};M.width=200,M.height=400,R.width=200,R.height=400;const T={drawBg:(t,e,r)=>((t,e,r)=>{I(F),F.fillStyle=\"#FFFF00\",F.strokeStyle=\"#000000\";for(let n=0;n<r;n++)C(F,t[n],n%e*20,20*parseInt(n/e));F.stroke()})(t,e,r),clearBg:()=>I(F)},H={drawShape:(t,e,r)=>((t,e,r)=>{I(B),B.fillStyle=\"#FFFF00\",B.strokeStyle=\"#000000\";for(let n=0,i=t.content.length;n<i;n++)for(let i=0,a=t.content[n].length;i<a;i++)C(B,t.content[n][i],20*(e+n),20*(r-a+1+i));B.stroke()})(t,e,r),clearBlock:()=>I(B)};var G=function(){const t=P.map[0],e=P.map[1],r=t*e;let n,i,a=!1,o=!1,s=[],u=0,c=0,h=0,f=0;document.addEventListener(\"keydown\",t=>{let e=t||window.event,r=h,i=f,s=c;if(a)return!1;if(null!==n){if(!0===o)return!1;if(37==e.keyCode||39==e.keyCode)return r+=e.keyCode%37-1,l(n[\"state\"+s],r,i)&&(h=r,H.drawShape(n[\"state\"+c],h,f)),!1;if(38==e.keyCode)return l(n[\"state\"+(s=c%u+1)],r,i)&&(c=s,H.drawShape(n[\"state\"+c],h,f)),!1;if(40==e.keyCode)return i+=1,l(n[\"state\"+s],r,i)&&(f=i,H.drawShape(n[\"state\"+c],h,f)),!1}});let l=(r,n,i)=>{let a=r.content,o=a.length,u=a[0].length;if(n<0||n+o>t||i>=e)return!1;for(let e=0;e<o;e++)for(let r=0;r<u;r++)if(1===s[n+e+(i-u+1+r)*t])return!1;return!0},p=()=>{if(a)return!1;n=P.shape[\"shape\"+parseInt(6*Math.random()+1)],u=n.stateNum,c=1,h=4,f=0},y=()=>{if(a)return!1;i=setInterval(function(){H.drawShape(n[\"state\"+c],h,f++),(f===e||((e,r,n)=>{let i=e.row,a=i.length;for(let e=0;e<a;e++){let a=(n+i[e])*t+r+e;if(1===s[a])return!0}return!1})(n[\"state\"+c],h,f))&&(((e,r,n)=>{let i=e.content;for(let e=0,o=i.length;e<o;e++)for(let o=0,u=i[e].length;o<u;o++){let c=r+e+(n-u+1+o)*t;if(c<0)return a=!0,!1;1===i[e][o]&&(s[c]=1)}})(n[\"state\"+c],h,f-1),H.clearBlock(),n=null,(()=>{let r=t;for(let t=e-1;t>0;t--){let e=0;for(;e<r&&0!==s[t*r+e];e++);if(e===r){let e=Array(r);e.fill(0),s.splice(t*r,r),s.splice(0,0,...e),t++}}})(),T.drawBg(s,t,r),clearInterval(i),a||(p(),y()))},1e3)};this.init=(()=>{let e=Array(r);e.fill(0),s=e,T.drawBg(s,t,r)}),this.start=(()=>{p(),y()}),this.stop=(()=>{o=!0,clearInterval(i)}),this.restart=(()=>{o=!1,y()})};let L=document.getElementById(\"elsfk-start\"),U=new G,D=V.initialState;U.init(),L.addEventListener(\"click\",function(){D=V.transition(D,\"GAME\").value,U.start()}),document.addEventListener(\"keydown\",t=>{80==(t||window.event).keyCode&&(\"stop\"===D&&U.restart(),\"start\"===D&&U.stop(),D=V.transition(D,\"GAME\").value)})}]);","extractedComments":[]}